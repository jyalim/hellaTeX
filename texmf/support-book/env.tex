%% Environment ---------------------------------------------------------
% Sets up tolerances, spacing, formats, counters, and various set ups.
% ----------------------------------------------------------------------

\DeclareRobustCommand\ebsfseries{\fontseries{eb}\selectfont}
\DeclareRobustCommand\sbsfseries{\fontseries{sb}\selectfont}
\DeclareRobustCommand\ltsfseries{\fontseries{l}\selectfont}
\DeclareRobustCommand\clsfseries{\fontseries{cl}\selectfont}

\DeclareTextFontCommand{\textebsf}{\ebseries}
\DeclareTextFontCommand{\textsbsf}{\sbseries}
\DeclareTextFontCommand{\textltsf}{\ltseries}
\DeclareTextFontCommand{\textclsf}{\clseries}

\def\ltsf{\sffamily\ltsfseries}

\tolerance=500
\predisplaypenalty=0
\clubpenalty=10000
\widowpenalty=10000

%% Spacing -------------------------------------------------------------
% Setup spacing and lengths of document
% ----------------------------------------------------------------------

\frenchspacing

\setlength{\textwidth}{.7000\paperwidth}
\setlength{\textheight}{.7727\paperheight}
\setlength{\oddsidemargin}{0in}
\setlength{\evensidemargin}{0in}
\setlength{\topmargin}{0in}
\setlength{\headheight}{0in}
\setlength{\headsep}{0in}
\setlength{\footskip}{.043\paperheight}

\setlength{\parskip}{1pt}
\setlength{\arraycolsep}{1.5pt}

\newdimen\myparindent
\setlength{\myparindent}{12pt}
\parindent\myparindent

\setlist{noitemsep}

%% Formats -------------------------------------------------------------
% Setup formats of document
% ----------------------------------------------------------------------

\titlelabel{\bf\boldmath\thetitle\ }
\titlespacing{\chapter}{0em}{-\footskip}{-\footskip}
%\titleformat{\chapter}{%
%  \normalfont\Large\bf}{Chapter\ \thechapter}{0em}{\vspace{-.5in}\\~#1}[]
\titleformat{\section}{\normalfont\large\bf}{\thesection}{0em}{~#1}
\titleformat{\subsection}{\normalfont\bf}{\thesubsection}{0em}{~#1}
\titleformat{\subsubsection}{\normalfont\it}{%
  \normalfont\thesubsubsection}{0em}{~#1}
%\titleformat{name=\chapter,numberless}{\normalfont\large\bf}{}{0em}{#1}
\titleformat{name=\section,numberless}{\normalfont\large\bf}{}{0em}{#1}
\titleformat{name=\subsection,numberless}{\normalfont\bf}{}{0em}{#1}
\titleformat{name=\subsubsection,numberless}{\normalfont\it}{}{0em}{#1}

%% Counters ------------------------------------------------------------
% Setup Counters for Document
% ----------------------------------------------------------------------

\numberwithin{equation}{subsection}
\setcounter{tocdepth}{2}
\setcounter{section}{0}

\newcounter{code}%[section]
\renewcommand{\thecode}{\arabic{section}.\arabic{code}}

\newcommand{\ccaption}[1]{%
  \refstepcounter{code}
  \caption*{Code \thecode: #1}
}

\newenvironment{codesnippet}{
  \begin{figure}[h]
    \centering
  }{
  \end{figure}
}

\newcommand{\codesnip}[4][/dev/null]{%
  \begin{codesnippet}
    \captionsetup{width=#3\linewidth}
    \verbatiminput{#1} 
    \ccaption{#4}
    \label{code:#2}
  \end{codesnippet}
}

%% Page Numbering ------------------------------------------------------
% Set up numbering style
% ----------------------------------------------------------------------


\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\def\clrpage{\setcounter{page}{1}}
\pagestyle{fancy} 
%\newcommand{\frontmatter}[1]{\cfoot{#1}\clrpage\pagenumbering{roman}}
%\newcommand{\mainmatter}[1]{\cfoot{#1}\clrpage\pagenumbering{arabic}}
%\newcommand{\backmatter}[1]{\cfoot{#1}\clrpage\pagenumbering{arabic}}

%% Various -------------------------------------------------------------
% Setup Various aspects of document
% ----------------------------------------------------------------------

\graphicspath{{figs/},{fig/},{img/}}

% From http://tex.stackexchange.com/questions/79058/
%   can-a-default-path-be-set-globally-for-input-akin-to-graphicspath

\makeatletter
  \def\input@path{{src/}{tex/}{tex/pgf/}{fig/pgf/}{figs/pgf/}}
\makeatother

\hypersetup{
  breaklinks=true,
  colorlinks,
  citecolor=blue,
  linkcolor=blue,
  urlcolor=blue,
}

%% - Listings ----------------------------------------------------------
% General ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\lstset{
  basicstyle=\small\ttfamily,
  breakatwhitespace=true,
  breaklines=true,
  %columns=flexible,%fixed, %fullflexible,
  captionpos=b,
  commentstyle=\bfseries\gray,
  extendedchars=true,
  identifierstyle=\blue,
  keepspaces=true,
  keywordstyle=\bfseries\cyan,
  numbers=left,
  numberstyle=\small\ttfamily,
  showtabs=false,
  showspaces=false,
  showstringspaces=false,
  stepnumber=9,
  stringstyle=\bfseries\green,
  tabsize=2,
  xleftmargin=0pt,
}

% Allow for centering
%  from http://tex.stackexchange.com/questions/85489/
%    how-to-center-a-lstlisting
% 
\makeatletter
\newenvironment{CenteredBox}{% 
  \begin{Sbox}
  }{
  \end{Sbox}
  \centerline{\parbox{\wd\@Sbox}{\TheSbox}}
}
\makeatother
\newenvironment{centerlst}{%
  \begin{figure}[H]\begin{CenteredBox}}{%
  \end{CenteredBox}\end{figure}
}

% Matlab +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
%  from http://tex.stackexchange.com/questions/75116/
%   what-can-i-use-to-typeset-matlab-code-in-my-document
% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\lstset{language=Matlab,%
    %basicstyle=\color{red},
    breaklines=true,%
    morekeywords={matlab2tikz},
    keywordstyle=\color{blue},%
    morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},
    identifierstyle=\color{black},%
    stringstyle=\color{lavenderindigo},
    commentstyle=\color{green},%
    showstringspaces=false,% 
    numbers=left,%
    numberstyle={\tiny\color{black}},% size of the numbers
    numbersep=9pt, % this defines how far the numbers are from the text
    emph=[1]{for,end,break},emphstyle=[1]\color{pDCyan}, 
    %emph=[2]{word1,word2}, emphstyle=[2]{style},    
}


